<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T10U3">p_new</span> ] = FABRIK(<span class="var type1" id="S3T10U6">p</span>,<span class="var type1" id="S4T1U7">t</span>,<span class="var type1" id="S5T10U8">allowed_theta_f</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">if</span>(<span class="mxinfo" id="T4:U5"><span class="mxinfo" id="T2:U6"><span class="var type1" id="S4T1U15">t</span>(<span class="mxinfo" id="T2:U8">2</span>)</span> &lt; <span class="mxinfo" id="T2:U9">0</span></span> || <span class="mxinfo" id="T4:U10"><span class="mxinfo" id="T2:U11">norm(<span class="var type1" id="S4T1U21">t</span>)</span> &lt; <span class="mxinfo" id="T2:U13">3</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">    <span class="mxinfo" id="T10:U14"><span class="var type1" id="S2T10U25">p_new</span> = <span class="var type1" id="S3T10U26">p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo" id="T2:U17"><span class="var type1" id="S7T2U30">n</span> = <span class="mxinfo" id="T2:U19">length(<span class="var type1" id="S3T10U33">p</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo" id="T11:U21"><span class="var type1" id="S9T11U36">d</span> = <span class="mxinfo" id="T11:U23">zeros(<span class="mxinfo" id="T2:U24"><span class="var type1" id="S7T2U40">n</span> - 1</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S11T2U45">i</span> = <span class="mxinfo" id="T2:U27">1</span>:(<span class="var type1" id="S7T2U50">n</span> -1)</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo" id="T1:U29"><span class="var type1" id="S12T1U54">X</span> = <span class="mxinfo" id="T1:U31"><span class="mxinfo" id="T1:U32"><span class="var type1" id="S3T10U57">p</span>(<span class="var type1" id="S11T2U58">i</span>,:)</span> - <span class="mxinfo" id="T1:U35"><span class="var type1" id="S3T10U61">p</span>(<span class="mxinfo" id="T2:U37"><span class="var type1" id="S11T2U63">i</span>+<span class="mxinfo" id="T2:U39">1</span></span>,:)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo" id="T2:U40"><span class="mxinfo" id="T2:U41"><span class="var type1" id="S9T11U69">d</span>(<span class="var type1" id="S11T2U70">i</span>)</span> = <span class="mxinfo" id="T2:U44">norm(<span class="var type1" id="S12T1U73">X</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="comment">%total_d = sum(d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo" id="T2:U46"><span class="var type1" id="S13T2U76">dist</span> = <span class="mxinfo" id="T2:U48">norm(<span class="mxinfo" id="T1:U49"><span class="mxinfo" id="T1:U50"><span class="var type1" id="S3T10U81">p</span>(<span class="mxinfo" id="T2:U52">1</span>,:)</span> - <span class="var type1" id="S4T1U84">t</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"><span class="comment">%Om armen är utanför räckvidden, kör bara en iteration av forward reaching</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T4:U54"><span class="var type1" id="S13T2U88">dist</span> &gt; <span class="mxinfo" id="T2:U56">sum(<span class="var type1" id="S9T11U91">d</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S11T2U94">i</span> = <span class="mxinfo" id="T2:U59">1</span>:<span class="var type1" id="S7T2U98">n</span>-1</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">        <span class="mxinfo" id="T2:U61"><span class="var type1" id="S15T2U102">r</span> = <span class="mxinfo" id="T2:U63">norm(<span class="mxinfo" id="T1:U64"><span class="var type1" id="S4T1U106">t</span> - <span class="mxinfo" id="T1:U66"><span class="var type1" id="S3T10U108">p</span>(<span class="var type1" id="S11T2U109">i</span>,:)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">        <span class="mxinfo" id="T2:U69"><span class="var type1" id="S16T2U113">gamma</span> = <span class="mxinfo" id="T2:U71"><span class="mxinfo" id="T2:U72"><span class="var type1" id="S9T11U116">d</span>(<span class="var type1" id="S11T2U117">i</span>)</span>/<span class="var type1" id="S15T2U118">r</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">        <span class="mxinfo" id="T1:U76"><span class="mxinfo" id="T1:U77"><span class="var type1" id="S3T10U122">p</span>(<span class="mxinfo" id="T2:U79"><span class="var type1" id="S11T2U124">i</span>+<span class="mxinfo" id="T2:U81">1</span></span>,:)</span> = <span class="mxinfo" id="T1:U82"><span class="mxinfo" id="T1:U83">(<span class="mxinfo" id="T2:U84"><span class="mxinfo" id="T2:U85">1</span> - <span class="var type1" id="S16T2U132">gamma</span></span>)*<span class="mxinfo" id="T1:U87"><span class="var type1" id="S3T10U134">p</span>(<span class="var type1" id="S11T2U135">i</span>,:)</span></span> + <span class="mxinfo" id="T1:U90"><span class="var type1" id="S16T2U138">gamma</span>*<span class="var type1" id="S4T1U139">t</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    <span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo" id="T1:U93"><span class="var type1" id="S17T1U143">b</span> = <span class="mxinfo" id="T1:U95"><span class="var type1" id="S3T10U145">p</span>(<span class="mxinfo" id="T2:U97">1</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo" id="T2:U98"><span class="var type1" id="S18T2U150">last_dif</span> = <span class="mxinfo" id="T2:U100">30</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo" id="T2:U101"><span class="var type1" id="S19T2U154">dif</span> = <span class="mxinfo" id="T2:U103">norm(<span class="mxinfo" id="T1:U104"><span class="mxinfo" id="T1:U105"><span class="var type1" id="S3T10U159">p</span>(<span class="mxinfo" id="T2:U107"><span class="var type1" id="S7T2U160">n</span></span>,:)</span> - <span class="var type1" id="S4T1U162">t</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">    <span class="keyword">while</span>(<span class="mxinfo" id="T4:U110"><span class="var type1" id="S19T2U167">dif</span> &gt; <span class="mxinfo" id="T2:U112">0.01</span></span> &amp;&amp; <span class="mxinfo" id="T4:U113"><span class="mxinfo" id="T2:U114"><span class="var type1" id="S18T2U171">last_dif</span> - <span class="var type1" id="S19T2U172">dif</span></span> &gt; <span class="mxinfo" id="T2:U117">0.000001</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">        <span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line">        <span class="mxinfo" id="T1:U118"><span class="mxinfo" id="T1:U119"><span class="var type1" id="S3T10U177">p</span>(<span class="mxinfo" id="T2:U121"><span class="var type1" id="S7T2U178">n</span></span>,:)</span> = <span class="var type1" id="S4T1U180">t</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line">        <span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line">        <span class="mxinfo" id="T2:U124"><span class="var type1" id="S15T2U183">r</span> = <span class="mxinfo" id="T2:U126">norm(<span class="mxinfo" id="T1:U127"><span class="mxinfo" id="T1:U128"><span class="var type1" id="S3T10U188">p</span>(<span class="mxinfo" id="T2:U130"><span class="var type1" id="S7T2U190">n</span>-1</span>,:)</span> - <span class="mxinfo" id="T1:U132"><span class="var type1" id="S3T10U194">p</span>(<span class="mxinfo" id="T2:U134"><span class="var type1" id="S7T2U195">n</span></span>,:)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line">        <span class="mxinfo" id="T2:U136"><span class="var type1" id="S16T2U199">gamma</span> = <span class="mxinfo" id="T2:U138"><span class="mxinfo" id="T2:U139"><span class="var type1" id="S9T11U202">d</span>(<span class="mxinfo" id="T2:U141"><span class="var type1" id="S7T2U204">n</span>-1</span>)</span>/<span class="var type1" id="S15T2U206">r</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line">        <span class="mxinfo" id="T1:U144"><span class="mxinfo" id="T1:U145"><span class="var type1" id="S3T10U210">p</span>(<span class="mxinfo" id="T2:U147"><span class="var type1" id="S7T2U212">n</span>-1</span>,:)</span> = <span class="mxinfo" id="T1:U149"><span class="mxinfo" id="T1:U150">(<span class="mxinfo" id="T2:U151"><span class="mxinfo" id="T2:U152">1</span> - <span class="var type1" id="S16T2U220">gamma</span></span>)*<span class="mxinfo" id="T1:U154"><span class="var type1" id="S3T10U222">p</span>(<span class="mxinfo" id="T2:U156"><span class="var type1" id="S7T2U223">n</span></span>,:)</span></span> + <span class="mxinfo" id="T1:U158"><span class="var type1" id="S16T2U226">gamma</span>*<span class="mxinfo" id="T1:U160"><span class="var type1" id="S3T10U228">p</span>(<span class="mxinfo" id="T2:U162"><span class="var type1" id="S7T2U230">n</span>-1</span>,:)</span></span></span></span>;   </span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line">        <span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S11T2U235">i</span> = <span class="mxinfo" id="T2:U165">2</span>:<span class="var type1" id="S7T2U239">n</span>-1</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">            <span class="mxinfo" id="T2:U167"><span class="var type1" id="S20T2U243">i2</span> = <span class="mxinfo" id="T2:U169"><span class="var type1" id="S7T2U245">n</span> - <span class="var type1" id="S11T2U246">i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">            <span class="comment">%p(i2,:) = follow_the_rules(p(i2+1,:),p(i2+2,:),p(i2,:),allowed_theta_b(i2+1,:));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line">            <span class="mxinfo" id="T2:U172"><span class="var type1" id="S15T2U249">r</span> = <span class="mxinfo" id="T2:U174">norm(<span class="mxinfo" id="T1:U175"><span class="mxinfo" id="T1:U176"><span class="var type1" id="S3T10U254">p</span>(<span class="var type1" id="S20T2U255">i2</span>,:)</span> - <span class="mxinfo" id="T1:U179"><span class="var type1" id="S3T10U258">p</span>(<span class="mxinfo" id="T2:U181"><span class="var type1" id="S20T2U260">i2</span>+<span class="mxinfo" id="T2:U183">1</span></span>,:)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">            <span class="mxinfo" id="T2:U184"><span class="var type1" id="S16T2U265">gamma</span> = <span class="mxinfo" id="T2:U186"><span class="mxinfo" id="T2:U187"><span class="var type1" id="S9T11U268">d</span>(<span class="var type1" id="S20T2U269">i2</span>)</span>/<span class="var type1" id="S15T2U270">r</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo" id="T1:U191"><span class="mxinfo" id="T1:U192"><span class="var type1" id="S3T10U274">p</span>(<span class="var type1" id="S20T2U275">i2</span>,:)</span> = <span class="mxinfo" id="T1:U195"><span class="mxinfo" id="T1:U196">(<span class="mxinfo" id="T2:U197"><span class="mxinfo" id="T2:U198">1</span> - <span class="var type1" id="S16T2U282">gamma</span></span>)*<span class="mxinfo" id="T1:U200"><span class="var type1" id="S3T10U284">p</span>(<span class="mxinfo" id="T2:U202"><span class="var type1" id="S20T2U286">i2</span>+<span class="mxinfo" id="T2:U204">1</span></span>,:)</span></span> + <span class="mxinfo" id="T1:U205"><span class="var type1" id="S16T2U290">gamma</span>*<span class="mxinfo" id="T1:U207"><span class="var type1" id="S3T10U292">p</span>(<span class="var type1" id="S20T2U293">i2</span>,:)</span></span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line">            <span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line">               </span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line">        <span class="mxinfo" id="T1:U210"><span class="mxinfo" id="T1:U211"><span class="var type1" id="S3T10U298">p</span>(<span class="mxinfo" id="T2:U213">1</span>,:)</span> = <span class="var type1" id="S17T1U301">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">48</a></span><span class="line">        <span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">49</a></span><span class="line">        <span class="mxinfo" id="T1:U215"><span class="mxinfo" id="T1:U216"><span class="var type1" id="S3T10U305">p</span>(<span class="mxinfo" id="T2:U218">2</span>,:)</span> = <span class="mxinfo" id="T1:U219"><span class="fcn" id="F128N6:B309">n_rules</span>(<span class="mxinfo" id="T1:U220"><span class="var type1" id="S3T10U311">p</span>(<span class="mxinfo" id="T2:U222">1</span>,:)</span>,<span class="mxinfo" id="T1:U223">[0 -1]</span>,<span class="mxinfo" id="T1:U224"><span class="var type1" id="S3T10U320">p</span>(<span class="mxinfo" id="T2:U226">2</span>,:)</span>,<span class="mxinfo" id="T1:U227"><span class="var type1" id="S5T10U324">allowed_theta_f</span>(<span class="mxinfo" id="T2:U229">1</span>,:)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">50</a></span><span class="line">        <span class="mxinfo" id="T2:U230"><span class="var type1" id="S15T2U329">r</span> = <span class="mxinfo" id="T2:U232">norm(<span class="mxinfo" id="T1:U233"><span class="mxinfo" id="T1:U234"><span class="var type1" id="S3T10U334">p</span>(<span class="mxinfo" id="T2:U236">1</span>,:)</span> - <span class="mxinfo" id="T1:U237"><span class="var type1" id="S3T10U338">p</span>(<span class="mxinfo" id="T2:U239">2</span>,:)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">51</a></span><span class="line">        <span class="mxinfo" id="T2:U240"><span class="var type1" id="S16T2U343">gamma</span> = <span class="mxinfo" id="T2:U242"><span class="mxinfo" id="T2:U243"><span class="var type1" id="S9T11U346">d</span>(<span class="mxinfo" id="T2:U245">1</span>)</span>/<span class="var type1" id="S15T2U348">r</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">52</a></span><span class="line">        <span class="mxinfo" id="T1:U247"><span class="mxinfo" id="T1:U248"><span class="var type1" id="S3T10U352">p</span>(<span class="mxinfo" id="T2:U250">2</span>,:)</span> = <span class="mxinfo" id="T1:U251"><span class="mxinfo" id="T1:U252">(<span class="mxinfo" id="T2:U253"><span class="mxinfo" id="T2:U254">1</span> - <span class="var type1" id="S16T2U360">gamma</span></span>)*<span class="mxinfo" id="T1:U256"><span class="var type1" id="S3T10U362">p</span>(<span class="mxinfo" id="T2:U258">1</span>,:)</span></span> + <span class="mxinfo" id="T1:U259"><span class="var type1" id="S16T2U366">gamma</span>*<span class="mxinfo" id="T1:U261"><span class="var type1" id="S3T10U368">p</span>(<span class="mxinfo" id="T2:U263">2</span>,:)</span></span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">53</a></span><span class="line"><span class="comment">%         plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">54</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S11T2U373">i</span> = <span class="mxinfo" id="T2:U265">2</span>:<span class="var type1" id="S7T2U377">n</span>-1</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">55</a></span><span class="line">            <span class="mxinfo" id="T1:U267"><span class="mxinfo" id="T1:U268"><span class="var type1" id="S3T10U382">p</span>(<span class="mxinfo" id="T2:U270"><span class="var type1" id="S11T2U384">i</span>+<span class="mxinfo" id="T2:U272">1</span></span>,:)</span> = <span class="mxinfo" id="T1:U273"><span class="fcn" id="F128N6:B388">n_rules</span>(<span class="mxinfo" id="T1:U274"><span class="var type1" id="S3T10U390">p</span>(<span class="var type1" id="S11T2U391">i</span>,:)</span>,<span class="mxinfo" id="T1:U277"><span class="var type1" id="S3T10U394">p</span>(<span class="mxinfo" id="T2:U279"><span class="var type1" id="S11T2U396">i</span>-<span class="mxinfo" id="T2:U281">1</span></span>,:)</span>,<span class="mxinfo" id="T1:U282"><span class="var type1" id="S3T10U400">p</span>(<span class="mxinfo" id="T2:U284"><span class="var type1" id="S11T2U402">i</span>+<span class="mxinfo" id="T2:U286">1</span></span>,:)</span>, <span class="mxinfo" id="T1:U287"><span class="var type1" id="S5T10U406">allowed_theta_f</span>(<span class="var type1" id="S11T2U407">i</span>,:)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">56</a></span><span class="line">            <span class="mxinfo" id="T2:U290"><span class="var type1" id="S15T2U411">r</span> = <span class="mxinfo" id="T2:U292">norm(<span class="mxinfo" id="T1:U293"><span class="mxinfo" id="T1:U294"><span class="var type1" id="S3T10U416">p</span>(<span class="var type1" id="S11T2U417">i</span>,:)</span> - <span class="mxinfo" id="T1:U297"><span class="var type1" id="S3T10U420">p</span>(<span class="mxinfo" id="T2:U299"><span class="var type1" id="S11T2U422">i</span>+<span class="mxinfo" id="T2:U301">1</span></span>,:)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">57</a></span><span class="line">            <span class="mxinfo" id="T2:U302"><span class="var type1" id="S16T2U427">gamma</span> = <span class="mxinfo" id="T2:U304"><span class="mxinfo" id="T2:U305"><span class="var type1" id="S9T11U430">d</span>(<span class="var type1" id="S11T2U431">i</span>)</span>/<span class="var type1" id="S15T2U432">r</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">58</a></span><span class="line">            <span class="mxinfo" id="T1:U309"><span class="mxinfo" id="T1:U310"><span class="var type1" id="S3T10U436">p</span>(<span class="mxinfo" id="T2:U312"><span class="var type1" id="S11T2U438">i</span>+<span class="mxinfo" id="T2:U314">1</span></span>,:)</span> = <span class="mxinfo" id="T1:U315"><span class="mxinfo" id="T1:U316">(<span class="mxinfo" id="T2:U317"><span class="mxinfo" id="T2:U318">1</span> - <span class="var type1" id="S16T2U446">gamma</span></span>)*<span class="mxinfo" id="T1:U320"><span class="var type1" id="S3T10U448">p</span>(<span class="var type1" id="S11T2U449">i</span>,:)</span></span> + <span class="mxinfo" id="T1:U323"><span class="var type1" id="S16T2U452">gamma</span>*<span class="mxinfo" id="T1:U325"><span class="var type1" id="S3T10U454">p</span>(<span class="mxinfo" id="T2:U327"><span class="var type1" id="S11T2U456">i</span>+<span class="mxinfo" id="T2:U329">1</span></span>,:)</span></span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">59</a></span><span class="line"><span class="comment">%             plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60">60</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61">61</a></span><span class="line">        <span class="mxinfo" id="T2:U330"><span class="var type1" id="S18T2U461">last_dif</span> = <span class="var type1" id="S19T2U462">dif</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62">62</a></span><span class="line">        <span class="mxinfo" id="T2:U333"><span class="var type1" id="S19T2U465">dif</span> = <span class="mxinfo" id="T2:U335">norm(<span class="mxinfo" id="T1:U336"><span class="mxinfo" id="T1:U337"><span class="var type1" id="S3T10U470">p</span>(<span class="mxinfo" id="T2:U339"><span class="var type1" id="S7T2U471">n</span></span>,:)</span> - <span class="var type1" id="S4T1U473">t</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63">63</a></span><span class="line">        <span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64">64</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65">65</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66">66</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67">67</a></span><span class="line"><span class="comment">%plot_arm(p,t,total_d);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68">68</a></span><span class="line"><span class="mxinfo" id="T10:U342"><span class="var type1" id="S2T10U476">p_new</span> = <span class="var type1" id="S3T10U477">p</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69">69</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70">70</a></span><span class="line"></span></span>
</pre>
